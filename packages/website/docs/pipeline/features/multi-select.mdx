---
id: multi-select
title: 行多选
---

行的多选：在表格最左侧或最右侧新增一列，为每一行生成一个复选框。

:::tip 批量选择
点击复选框时，按住 shift 键可以进行批量选择/反选。
:::

### 示例

```jsx live
function 行多选() {
  const { dataSource4, columns4 } = assets.biz

  const pipeline = useTablePipeline({ components: fusion })
    .input({ dataSource: dataSource4, columns: columns4 })
    .primaryKey('id') // 每一行数据由 id 字段唯一标记
    .use(
      features.multiSelect({
        highlightRowWhenSelected: true,
        defaultValue: { keys: ['1', '2'], lastKey: '1' },
        checkboxPlacement: 'start',
        checkboxColumn: { lock: true },
      }),
    )

  return (
    <>
      <assets.FusionStyles />
      <BaseTable {...pipeline.getProps()} />
    </>
  )
}
```

### 使用方式

- 启用行多选功能之前，pipeline 必须已经设置了 primaryKey。
- 行多选依赖复选框组件，使用 multiSelect 之前需要通过 pipeline context 设置 components.Checkbox。
- 避免同时使用 非受控和受控的用法。

```jsx
pipeline.use(features.multiSelect(options))
```

options 结构如下：

```ts
export interface MultiSelectFeatureOptions {
  /** 是否高亮被选中的行 */
  highlightRowWhenSelected?: boolean

  /** 非受控用法：默认选中的 keys 与 lastKey */
  defaultValue?: string[] | { keys: string[]; lastKey?: string }

  /** 受控用法：当前选中的 keys 与上一次操作的 key */
  value?: string[] | { keys: string[]; lastKey?: string }

  /** 受控用法：状态改变回调  */
  onChange?: (next: { keys: string[]; lastKey: string }, keys: string[], action: 'check' | 'uncheck') => void

  /** 复选框所在列的位置 */
  checkboxPlacement?: 'start' | 'end'

  /** 复选框所在列的 column 配置，可指定 width，lock 等属性 */
  checkboxColumn?: Partial<ArtColumn>

  // todo isDisabled, clickArea: 'checkbox' | 'cell' | 'row'
}
```

:::note value 的格式
因为要实现「批量选择/反选」的功能，multiSelect 需要记录上一次操作的 key，故 value 的格式为 `{ keys: string[]; lastKey?: string }`。
:::
